### ============================================
### FARMAZON DEMO - API TEST DOSYASI
### Visual Studio 2022+ veya VS Code REST Client ile çalışır
### ============================================

@baseUrl = https://localhost:7001
@contentType = application/json

### ============================================
### AUTH - Kimlik Doğrulama
### ============================================

### Kullanıcı Kayıt
POST {{baseUrl}}/api/auth/register
Content-Type: {{contentType}}

{
    "name": "Test Kullanıcı",
    "email": "test@example.com",
    "username": "testuser",
    "password": "Test123!",
    "confirmPassword": "Test123!"
}

### Giriş Yap
# @name login
POST {{baseUrl}}/api/auth/login
Content-Type: {{contentType}}

{
    "email": "test@example.com",
    "password": "Test123!"
}

### Token'ı kaydet (login response'undan)
@authToken = {{login.response.body.$.token}}

### Mevcut Kullanıcı Bilgisi
GET {{baseUrl}}/api/auth/me
Authorization: Bearer {{authToken}}

### Token Yenile
POST {{baseUrl}}/api/auth/refresh
Content-Type: {{contentType}}

{
    "refreshToken": "your-refresh-token-here"
}

### Şifre Sıfırlama İsteği
POST {{baseUrl}}/api/auth/forgot-password
Content-Type: {{contentType}}

{
    "email": "test@example.com"
}

### Çıkış Yap
POST {{baseUrl}}/api/auth/logout
Authorization: Bearer {{authToken}}

### ============================================
### PRODUCTS - Ürünler
### ============================================

### Tüm Ürünleri Listele
GET {{baseUrl}}/api/products?page=1&pageSize=10

### Ürün Ara
GET {{baseUrl}}/api/products?search=vitamin&page=1&pageSize=10

### Kategoriye Göre Ürünler
GET {{baseUrl}}/api/products?categoryId=1&page=1&pageSize=10

### Tek Ürün Detayı
GET {{baseUrl}}/api/products/1

### Ürün Oluştur (Admin/Seller)
POST {{baseUrl}}/api/products
Authorization: Bearer {{authToken}}
Content-Type: {{contentType}}

{
    "productName": "Vitamin C 1000mg",
    "description": "Güçlü bağışıklık desteği için C vitamini takviyesi",
    "categoryId": 1,
    "brandId": 1,
    "isActive": true
}

### Ürün Güncelle
PUT {{baseUrl}}/api/products/1
Authorization: Bearer {{authToken}}
Content-Type: {{contentType}}

{
    "productName": "Vitamin C 1000mg - Güncellendi",
    "description": "Güncellenmiş açıklama",
    "categoryId": 1,
    "brandId": 1,
    "isActive": true
}

### ============================================
### LISTINGS - Satıcı Listingleri
### ============================================

### Tüm Listingleri Getir
GET {{baseUrl}}/api/listings?page=1&pageSize=10

### Fiyat Aralığına Göre
GET {{baseUrl}}/api/listings?minPrice=10&maxPrice=100&page=1&pageSize=10

### Tek Listing Detayı
GET {{baseUrl}}/api/listings/1

### Listing Oluştur (Seller)
POST {{baseUrl}}/api/listings
Authorization: Bearer {{authToken}}
Content-Type: {{contentType}}

{
    "productId": 1,
    "price": 49.99,
    "stockQuantity": 100,
    "sku": "VIT-C-1000",
    "condition": "New",
    "isActive": true
}

### Listing Güncelle
PUT {{baseUrl}}/api/listings/1
Authorization: Bearer {{authToken}}
Content-Type: {{contentType}}

{
    "price": 45.99,
    "stockQuantity": 150,
    "isActive": true
}

### ============================================
### CART - Sepet
### ============================================

### Kendi Sepetimi Getir
GET {{baseUrl}}/api/cart/my
Authorization: Bearer {{authToken}}

### Sepete Ürün Ekle
POST {{baseUrl}}/api/cart/add
Authorization: Bearer {{authToken}}
Content-Type: {{contentType}}

{
    "userId": 1,
    "listingId": 1,
    "quantity": 2
}

### Sepet Ürün Miktarını Güncelle
PUT {{baseUrl}}/api/cart/1/item/1
Authorization: Bearer {{authToken}}
Content-Type: {{contentType}}

{
    "quantity": 3
}

### Sepetten Ürün Kaldır
DELETE {{baseUrl}}/api/cart/1/item/1
Authorization: Bearer {{authToken}}

### ============================================
### ORDERS - Siparişler
### ============================================

### Checkout - Sipariş Oluştur
POST {{baseUrl}}/api/orders/checkout
Authorization: Bearer {{authToken}}
Content-Type: {{contentType}}

{
    "shippingAddressId": 1,
    "billingAddressId": 1,
    "customerNote": "Lütfen kapıya bırakın"
}

### Siparişlerimi Listele
GET {{baseUrl}}/api/orders?page=1&pageSize=10
Authorization: Bearer {{authToken}}

### Sipariş Detayı
GET {{baseUrl}}/api/orders/1
Authorization: Bearer {{authToken}}

### Sipariş Numarasıyla Sorgula
GET {{baseUrl}}/api/orders/by-number/ORD-20260205-ABCD1234
Authorization: Bearer {{authToken}}

### Sipariş İptal Et
POST {{baseUrl}}/api/orders/1/cancel
Authorization: Bearer {{authToken}}
Content-Type: {{contentType}}

{
    "reason": "Vazgeçtim",
    "note": "Başka bir ürün almaya karar verdim"
}

### İade Talebi Oluştur
POST {{baseUrl}}/api/orders/1/refund
Authorization: Bearer {{authToken}}
Content-Type: {{contentType}}

{
    "reason": "Hasarlı ürün",
    "description": "Paket açıldığında ürün kırık çıktı",
    "amount": 49.99
}

### ============================================
### PAYMENTS - Ödemeler
### ============================================

### Ödeme Intent Oluştur
POST {{baseUrl}}/api/payments/intent
Authorization: Bearer {{authToken}}
Content-Type: {{contentType}}

{
    "orderId": 1,
    "currency": "TRY",
    "method": "CreditCard"
}

### Kart ile Ödeme Yap
POST {{baseUrl}}/api/payments/intent
Authorization: Bearer {{authToken}}
Content-Type: {{contentType}}

{
    "orderId": 1,
    "currency": "TRY",
    "method": "CreditCard",
    "cardDetails": {
        "cardNumber": "4111111111111111",
        "cardHolderName": "Test User",
        "expireMonth": "12",
        "expireYear": "2028",
        "cvc": "123"
    },
    "returnUrl": "https://localhost:7001/payment/callback"
}

### Ödeme Durumu Sorgula
GET {{baseUrl}}/api/payments/1
Authorization: Bearer {{authToken}}

### Ödeme Simülasyonu - Başarılı (Test için)
POST {{baseUrl}}/api/payments/1/simulate/success
Authorization: Bearer {{authToken}}
Content-Type: {{contentType}}

{
    "note": "Test payment success"
}

### Ödeme Simülasyonu - Başarısız (Test için)
POST {{baseUrl}}/api/payments/1/simulate/fail
Authorization: Bearer {{authToken}}
Content-Type: {{contentType}}

{
    "note": "Test payment failure"
}

### BIN Kontrolü
POST {{baseUrl}}/api/payments/bin-check
Authorization: Bearer {{authToken}}
Content-Type: {{contentType}}

{
    "binNumber": "411111"
}

### Taksit Seçenekleri
POST {{baseUrl}}/api/payments/installments
Authorization: Bearer {{authToken}}
Content-Type: {{contentType}}

{
    "binNumber": "411111",
    "price": 500.00
}

### ============================================
### PROFILE - Kullanıcı Profili
### ============================================

### Profil Bilgilerini Getir
GET {{baseUrl}}/api/profile
Authorization: Bearer {{authToken}}

### Profil Güncelle
PUT {{baseUrl}}/api/profile
Authorization: Bearer {{authToken}}
Content-Type: {{contentType}}

{
    "name": "Güncellenmiş İsim",
    "phone": "+905551234567",
    "username": "newusername"
}

### Şifre Değiştir
POST {{baseUrl}}/api/profile/change-password
Authorization: Bearer {{authToken}}
Content-Type: {{contentType}}

{
    "currentPassword": "Test123!",
    "newPassword": "NewTest456!"
}

### Adreslerimi Listele
GET {{baseUrl}}/api/profile/addresses
Authorization: Bearer {{authToken}}

### Yeni Adres Ekle
POST {{baseUrl}}/api/profile/addresses
Authorization: Bearer {{authToken}}
Content-Type: {{contentType}}

{
    "title": "Ev",
    "fullName": "Test Kullanıcı",
    "phone": "+905551234567",
    "city": "İstanbul",
    "district": "Kadıköy",
    "neighborhood": "Caferağa",
    "addressLine": "Test Sokak No: 1 D: 5",
    "postalCode": "34710",
    "isDefault": true,
    "type": "Shipping"
}

### Adres Güncelle
PUT {{baseUrl}}/api/profile/addresses/1
Authorization: Bearer {{authToken}}
Content-Type: {{contentType}}

{
    "title": "Ev - Güncellendi",
    "fullName": "Test Kullanıcı",
    "phone": "+905559876543",
    "city": "İstanbul",
    "district": "Beşiktaş",
    "addressLine": "Yeni Adres Satırı",
    "isDefault": true,
    "type": "Shipping"
}

### Adres Sil
DELETE {{baseUrl}}/api/profile/addresses/1
Authorization: Bearer {{authToken}}

### Bildirim Tercihlerini Getir
GET {{baseUrl}}/api/profile/notification-preferences
Authorization: Bearer {{authToken}}

### Bildirim Tercihlerini Güncelle
PUT {{baseUrl}}/api/profile/notification-preferences
Authorization: Bearer {{authToken}}
Content-Type: {{contentType}}

{
    "emailOrderUpdates": true,
    "emailPromotions": false,
    "pushOrderUpdates": true,
    "pushPromotions": false,
    "smsOrderUpdates": false
}

### ============================================
### NOTIFICATIONS - Bildirimler
### ============================================

### Bildirimlerimi Listele
GET {{baseUrl}}/api/notifications?page=1&pageSize=20
Authorization: Bearer {{authToken}}

### Okunmamış Bildirim Sayısı
GET {{baseUrl}}/api/notifications/unread-count
Authorization: Bearer {{authToken}}

### Bildirimi Okundu İşaretle
POST {{baseUrl}}/api/notifications/1/read
Authorization: Bearer {{authToken}}

### Tüm Bildirimleri Okundu İşaretle
POST {{baseUrl}}/api/notifications/mark-all-read
Authorization: Bearer {{authToken}}

### ============================================
### CATEGORIES - Kategoriler
### ============================================

### Tüm Kategoriler
GET {{baseUrl}}/api/categories

### Kategori Detayı
GET {{baseUrl}}/api/categories/1

### Alt Kategoriler
GET {{baseUrl}}/api/categories/1/subcategories

### ============================================
### SHIPMENTS - Kargo
### ============================================

### Kargo Durumu Sorgula
GET {{baseUrl}}/api/shipments/1
Authorization: Bearer {{authToken}}

### Kargo Timeline
GET {{baseUrl}}/api/shipments/1/timeline
Authorization: Bearer {{authToken}}

### ============================================
### ADMIN - Yönetim Paneli (Admin Only)
### ============================================

### Dashboard İstatistikleri
GET {{baseUrl}}/api/admin/dashboard
Authorization: Bearer {{authToken}}

### Tüm Kullanıcıları Listele
GET {{baseUrl}}/api/admin/users?page=1&pageSize=20
Authorization: Bearer {{authToken}}

### Kullanıcı Detayı
GET {{baseUrl}}/api/admin/users/1
Authorization: Bearer {{authToken}}

### Kullanıcı Rolü Güncelle
PATCH {{baseUrl}}/api/admin/users/1/role
Authorization: Bearer {{authToken}}
Content-Type: {{contentType}}

{
    "role": "Seller"
}

### Tüm Siparişleri Listele (Admin)
GET {{baseUrl}}/api/admin/orders?page=1&pageSize=20
Authorization: Bearer {{authToken}}

### Sipariş Durumu Güncelle (Admin)
PATCH {{baseUrl}}/api/admin/orders/1/status
Authorization: Bearer {{authToken}}
Content-Type: {{contentType}}

{
    "status": "Processing",
    "note": "Sipariş hazırlanıyor"
}

### Tüm Ödemeleri Listele (Admin)
GET {{baseUrl}}/api/admin/payments?page=1&pageSize=20
Authorization: Bearer {{authToken}}

### Tüm Ürünleri Listele (Admin)
GET {{baseUrl}}/api/admin/products?page=1&pageSize=20
Authorization: Bearer {{authToken}}

### Tüm Listingleri Yönet (Admin)
GET {{baseUrl}}/api/admin/listings?page=1&pageSize=20
Authorization: Bearer {{authToken}}

### İade Taleplerini Listele (Admin)
GET {{baseUrl}}/api/admin/orders/refunds?page=1&pageSize=20
Authorization: Bearer {{authToken}}

### İade Talebini İşle (Admin)
POST {{baseUrl}}/api/admin/orders/refunds/1/process
Authorization: Bearer {{authToken}}
Content-Type: {{contentType}}

{
    "approve": true,
    "note": "İade onaylandı, tutar iade edilecek"
}

### Kampanyaları Listele (Admin)
GET {{baseUrl}}/api/admin/campaigns?page=1&pageSize=20
Authorization: Bearer {{authToken}}

### Yeni Kampanya Oluştur (Admin)
POST {{baseUrl}}/api/admin/campaigns
Authorization: Bearer {{authToken}}
Content-Type: {{contentType}}

{
    "name": "Yaz İndirimi",
    "description": "Tüm ürünlerde %20 indirim",
    "discountType": "Percentage",
    "discountValue": 20,
    "startDate": "2026-06-01T00:00:00Z",
    "endDate": "2026-08-31T23:59:59Z",
    "isActive": true,
    "minOrderAmount": 100,
    "maxUsageCount": 1000
}

### Destek Taleplerini Listele (Admin)
GET {{baseUrl}}/api/admin/support-tickets?page=1&pageSize=20
Authorization: Bearer {{authToken}}

### Satıcı Ödemelerini Listele (Admin)
GET {{baseUrl}}/api/admin/payouts?page=1&pageSize=20
Authorization: Bearer {{authToken}}

### Site Ayarlarını Getir (Admin)
GET {{baseUrl}}/api/admin/settings
Authorization: Bearer {{authToken}}

### Audit Loglarını Getir (Admin)
GET {{baseUrl}}/api/admin/audit-logs?page=1&pageSize=50
Authorization: Bearer {{authToken}}

### Raporlar - Satış Özeti (Admin)
GET {{baseUrl}}/api/admin/reports/sales-summary?fromDate=2026-01-01&toDate=2026-12-31
Authorization: Bearer {{authToken}}

### Raporlar - Kategori Performansı (Admin)
GET {{baseUrl}}/api/admin/reports/category-performance?fromDate=2026-01-01&toDate=2026-12-31
Authorization: Bearer {{authToken}}

### ============================================
### HEALTH CHECK
### ============================================

### Health Check
GET {{baseUrl}}/health

### Ready Check
GET {{baseUrl}}/health/ready

### ============================================
### NOTLAR
### ============================================
# 1. İlk olarak /api/auth/register ile kayıt olun
# 2. /api/auth/login ile giriş yapın
# 3. Dönen token'ı @authToken değişkenine kopyalayın
# 4. Diğer endpointleri test edin
#
# Visual Studio'da: .http dosyasını açın, "Send Request" butonuna tıklayın
# VS Code'da: REST Client eklentisini kurun, Ctrl+Alt+R ile istek gönderin
